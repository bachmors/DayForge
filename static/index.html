<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DayForge v5</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;800;900&family=IBM+Plex+Sans:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root{--p:#6C5CE7;--pl:#a855f7;--pd:#4a3aa0;--o:#FD7014;--g:#00B894;--r:#e74c3c;--bg:#0a0a1a;--card:#12122a;--sb:#0e0e22;--brd:rgba(108,92,231,0.2);--tx:#e8e8f0;--dim:#8888aa;--wh:#fff;--hbg:rgba(168,85,247,0.08);--hbr:rgba(168,85,247,0.25)}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'IBM Plex Sans',sans-serif;background:var(--bg);color:var(--tx);min-height:100vh}
body::before{content:'';position:fixed;inset:0;background:radial-gradient(ellipse at 20% 20%,rgba(108,92,231,0.06) 0%,transparent 50%),radial-gradient(ellipse at 80% 80%,rgba(253,112,20,0.04) 0%,transparent 50%);pointer-events:none;z-index:0}
#loginScreen{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;position:relative;z-index:1}
.lbox{background:var(--card);border:1px solid var(--brd);border-radius:20px;padding:48px 40px;width:380px;text-align:center}
.lbox h1{font-family:'Playfair Display',serif;font-weight:800;font-size:2.4rem;background:linear-gradient(135deg,var(--pl),var(--o));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:8px}
.lbox .sub{color:var(--dim);font-size:.9rem;margin-bottom:32px;font-weight:300}
.lbox input{width:100%;padding:12px 16px;background:var(--bg);border:1px solid var(--brd);border-radius:10px;color:var(--tx);font-family:inherit;font-size:.95rem;margin-bottom:12px;outline:none}
.lbox input:focus{border-color:var(--p)}
.lbox button{width:100%;padding:12px;background:linear-gradient(135deg,var(--p),var(--pd));color:#fff;border:none;border-radius:10px;font-weight:600;font-size:1rem;cursor:pointer;margin-top:8px}
.lerr{color:var(--r);font-size:.85rem;margin-top:12px;min-height:20px}
#appScreen{display:none;position:relative;z-index:1;height:100vh}
.hdr{display:flex;align-items:center;justify-content:space-between;padding:8px 20px;border-bottom:1px solid var(--brd);background:rgba(10,10,26,.9);backdrop-filter:blur(12px);position:sticky;top:0;z-index:100;height:48px}
.hdr-l{display:flex;align-items:center;gap:12px}
.logo{font-family:'Playfair Display',serif;font-weight:800;font-size:1.2rem;background:linear-gradient(135deg,var(--pl),var(--o));-webkit-background-clip:text;-webkit-text-fill-color:transparent;cursor:pointer}
.hdr-r{display:flex;align-items:center;gap:8px}
.hb{background:none;border:1px solid var(--brd);color:var(--dim);padding:3px 9px;border-radius:6px;font-size:.73rem;cursor:pointer;font-family:inherit;transition:all .2s;position:relative}.hb:hover{border-color:var(--p);color:var(--tx)}.hb.active{border-color:var(--o);color:var(--o)}
.badge{position:absolute;top:-6px;right:-6px;background:var(--o);color:#fff;font-size:.58rem;width:15px;height:15px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700}
.dev{display:flex;align-items:center;gap:5px;font-size:.7rem;color:var(--dim);font-family:'JetBrains Mono',monospace}
.ddot{width:7px;height:7px;border-radius:50%;background:var(--g);animation:pls 2s infinite}.ddot.off{background:var(--r);animation:none}
@keyframes pls{0%,100%{opacity:1}50%{opacity:.4}}
.grid{display:grid;grid-template-columns:220px 1fr;height:calc(100vh - 48px);overflow:hidden}
.sb{background:var(--sb);border-right:1px solid var(--brd);overflow-y:auto;padding:12px 0;display:flex;flex-direction:column}
.sbs{padding:0 12px;margin-bottom:14px}.sbt{font-family:'JetBrains Mono',monospace;font-size:.6rem;color:var(--dim);text-transform:uppercase;letter-spacing:1.5px;margin-bottom:6px;padding:0 4px}
.sw{display:flex;align-items:center;gap:7px;padding:6px 8px;border-radius:7px;cursor:pointer;transition:all .15s;font-size:.84rem;position:relative}.sw:hover{background:rgba(255,255,255,.04)}.sw.on{background:rgba(108,92,231,.15);color:var(--wh)}
.sw .ic{font-size:1rem}.sw .nm{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.sw .ct{font-family:'JetBrains Mono',monospace;font-size:.6rem;color:var(--dim);background:rgba(255,255,255,.05);padding:1px 5px;border-radius:3px}.sw .fr{position:absolute;right:3px;top:3px;font-size:.65rem}
.sw .hint{display:none;position:absolute;left:100%;top:0;margin-left:8px;background:var(--card);border:1px solid var(--hbr);border-radius:8px;padding:6px 10px;font-size:.72rem;color:var(--pl);white-space:nowrap;z-index:50;max-width:220px;white-space:normal;line-height:1.3;box-shadow:0 4px 12px rgba(0,0,0,.4)}.sw:hover .hint{display:block}
.sadd{display:flex;align-items:center;gap:7px;padding:4px 8px;border-radius:7px;cursor:pointer;color:var(--dim);font-size:.78rem;transition:all .15s}.sadd:hover{background:rgba(255,255,255,.04);color:var(--pl)}
.sp{display:flex;align-items:center;gap:5px;padding:3px 8px;border-radius:5px;font-size:.76rem;color:var(--dim);transition:all .15s;cursor:default}.sp:hover{background:rgba(255,255,255,.04);color:var(--tx)}
.sp a{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;text-decoration:none;color:inherit;font-size:.76rem}
.sp .ax{display:flex;gap:1px;opacity:0;transition:opacity .15s}.sp:hover .ax{opacity:1}
.xb{background:none;border:none;color:var(--dim);cursor:pointer;font-size:.68rem;padding:2px}.xb:hover{color:var(--pl)}
.sa{display:flex;align-items:center;gap:6px;padding:4px 8px;border-radius:7px;font-size:.8rem;transition:all .15s}.sa:hover{background:rgba(255,255,255,.04)}
.ack{width:15px;height:15px;border:2px solid var(--brd);border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:.6rem;color:transparent;transition:all .2s;flex-shrink:0;cursor:pointer}.ack.on{background:var(--g);border-color:var(--g);color:#fff}
.sa .nm{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:pointer}
.sa .dl{background:none;border:none;color:var(--dim);cursor:pointer;font-size:.65rem;opacity:0;transition:opacity .15s}.sa:hover .dl{opacity:1}
.slaunch{display:block;width:calc(100% - 6px);margin:6px 3px 0;padding:6px;background:linear-gradient(135deg,var(--o),#e85d04);color:#fff;border:none;border-radius:7px;font-family:inherit;font-weight:600;font-size:.78rem;cursor:pointer}.slaunch:disabled{opacity:.3;cursor:not-allowed}
.srow{display:flex;gap:3px;margin-top:5px;padding:0 3px}.srow input{flex:1;padding:4px 7px;background:var(--bg);border:1px solid var(--brd);border-radius:5px;color:var(--tx);font-size:.7rem;font-family:inherit;outline:none}.srow button{padding:4px 7px;background:var(--p);color:#fff;border:none;border-radius:5px;font-size:.7rem;cursor:pointer}
.cnt{overflow-y:auto;padding:18px 24px;position:relative}
.cnt.focus-mode{padding:24px 60px;max-width:900px;margin:0 auto}
.hyp{background:var(--hbg);border:1px solid var(--hbr);border-radius:13px;padding:10px 14px;margin-bottom:16px;display:flex;align-items:flex-start;gap:10px;animation:br 4s ease-in-out infinite}
@keyframes br{0%,100%{border-color:rgba(168,85,247,.25)}50%{border-color:rgba(168,85,247,.45)}}
.hyp .av{width:30px;height:30px;background:linear-gradient(135deg,var(--p),#ec4899);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.9rem;flex-shrink:0}
.hyp .bd{flex:1}.hyp .lb{font-family:'JetBrains Mono',monospace;font-size:.58rem;color:var(--pl);text-transform:uppercase;letter-spacing:1px;margin-bottom:2px}.hyp .mg{font-size:.85rem;line-height:1.5;font-weight:300}
.hyp .rf{background:none;border:none;color:var(--pl);cursor:pointer;font-size:.9rem;opacity:.5;flex-shrink:0}.hyp .rf:hover{opacity:1}
.wh{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;flex-wrap:wrap;gap:6px}
.wh-l{display:flex;align-items:center;gap:8px}.wh-l .ic{font-size:1.3rem}.wh-l h2{font-family:'Playfair Display',serif;font-weight:700;font-size:1.15rem}
.wh-r{display:flex;gap:5px}
.wb{background:none;border:1px solid var(--brd);color:var(--dim);padding:3px 9px;border-radius:6px;font-size:.73rem;cursor:pointer;font-family:inherit;transition:all .2s}.wb:hover{border-color:var(--p);color:var(--tx)}.wb.fon{border-color:var(--o);color:var(--o)}
.cb{display:flex;gap:5px;margin-bottom:12px;flex-wrap:wrap;align-items:center}
.cp{padding:3px 10px;border-radius:14px;font-size:.75rem;cursor:pointer;transition:all .2s;border:1px solid var(--brd);background:none;color:var(--dim);font-family:inherit}.cp:hover{border-color:var(--p);color:var(--tx)}.cp.on{background:rgba(108,92,231,.2);border-color:var(--p);color:var(--pl)}.cp .n{font-family:'JetBrains Mono',monospace;font-size:.58rem;margin-left:3px;opacity:.6}
.il{font-family:'JetBrains Mono',monospace;font-size:.62rem;color:var(--dim);text-transform:uppercase;letter-spacing:1px;margin:10px 0 5px}
.it{display:flex;align-items:center;gap:6px;padding:6px 8px;border-radius:7px;transition:background .15s}.it:hover{background:rgba(255,255,255,.03)}.it.dn{opacity:.3}
.ik{width:16px;height:16px;border:2px solid var(--brd);border-radius:4px;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:all .2s;color:transparent;font-size:.6rem}.ik:hover{border-color:var(--g)}.ik.on{background:var(--g);border-color:var(--g);color:#fff}
.it .tp{font-size:.8rem;flex-shrink:0}.it .lb{flex:1;font-size:.84rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:pointer}.it .lb:hover{color:var(--pl)}.it.dn .lb{text-decoration:line-through;cursor:default}
.it .vl{font-family:'JetBrains Mono',monospace;font-size:.6rem;color:var(--dim);max-width:140px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.it .nt{font-size:.68rem;color:var(--pl);max-width:100px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-style:italic}
.it .cat-tag{font-size:.58rem;color:var(--pl);background:rgba(108,92,231,.1);padding:1px 5px;border-radius:3px}
.it .ia{display:flex;gap:1px;opacity:0;transition:opacity .15s}.it:hover .ia{opacity:1}
.ab{background:none;border:none;color:var(--dim);cursor:pointer;font-size:.73rem;padding:2px;transition:color .15s}.ab:hover{color:var(--pl)}.ab.dl:hover{color:var(--r)}
.lnch{background:none;border:1px solid rgba(0,184,148,.3);color:var(--g);cursor:pointer;font-size:.68rem;padding:2px 6px;border-radius:4px;transition:all .2s;font-family:inherit}.lnch:hover{background:rgba(0,184,148,.15);border-color:var(--g)}
.ar{display:flex;gap:4px;margin-top:8px;padding-top:8px;border-top:1px solid rgba(108,92,231,.1)}
.ar select,.ar input{padding:5px 8px;background:var(--bg);border:1px solid var(--brd);border-radius:6px;color:var(--tx);font-family:inherit;font-size:.78rem;outline:none}.ar select{width:72px}.ar input{flex:1}.ar input:focus,.ar select:focus{border-color:var(--p)}
.ar button{padding:5px 10px;background:var(--p);color:#fff;border:none;border-radius:6px;font-weight:600;font-size:.78rem;cursor:pointer;white-space:nowrap}
.fgs{text-align:center;margin:20px 0 12px}
.fg{padding:12px 36px;background:linear-gradient(135deg,var(--o),#e85d04);color:#fff;border:none;border-radius:11px;font-family:'Playfair Display',serif;font-weight:800;font-size:1.1rem;cursor:pointer;transition:all .3s;box-shadow:0 4px 20px rgba(253,112,20,.3)}.fg:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(253,112,20,.5)}
.fc{font-family:'JetBrains Mono',monospace;font-size:.7rem;color:var(--dim);margin-top:5px}
.emp{text-align:center;padding:50px 20px;color:var(--dim)}.emp .ic{font-size:2.5rem;margin-bottom:10px}.emp p{font-size:.88rem;font-weight:300;line-height:1.6}
/* DASHBOARD */
.dash{padding:4px 0}
.dash-stats{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:18px}
.ds{background:var(--card);border:1px solid var(--brd);border-radius:10px;padding:14px;text-align:center}.ds .num{font-family:'Playfair Display',serif;font-size:1.8rem;font-weight:800;background:linear-gradient(135deg,var(--pl),var(--o));-webkit-background-clip:text;-webkit-text-fill-color:transparent}.ds .lbl{font-size:.7rem;color:var(--dim);margin-top:2px}
.dash-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:10px}
.dwc{background:var(--card);border:1px solid var(--brd);border-radius:10px;padding:14px;cursor:pointer;transition:all .2s;position:relative}.dwc:hover{border-color:var(--p);transform:translateY(-1px)}
.dwc .top{display:flex;align-items:center;gap:8px;margin-bottom:8px}.dwc .top .ic{font-size:1.2rem}.dwc .top .nm{font-weight:600;font-size:.9rem;flex:1}
.dwc .top .st{font-size:.6rem;padding:2px 6px;border-radius:4px;font-family:'JetBrains Mono',monospace}
.dwc .top .st.forged{background:rgba(253,112,20,.15);color:var(--o)}.dwc .top .st.active{background:rgba(0,184,148,.1);color:var(--g)}
.dwc .bar{height:4px;background:rgba(255,255,255,.05);border-radius:2px;margin-bottom:6px;overflow:hidden}.dwc .bar .fill{height:100%;border-radius:2px;background:linear-gradient(90deg,var(--g),var(--pl));transition:width .3s}
.dwc .meta{display:flex;gap:10px;font-size:.72rem;color:var(--dim)}.dwc .meta span{display:flex;align-items:center;gap:3px}
.dwc .insight{font-size:.7rem;color:var(--pl);margin-top:6px;font-style:italic;min-height:16px}
/* SEARCH */
.search-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.7);backdrop-filter:blur(6px);z-index:250;align-items:flex-start;justify-content:center;padding-top:15vh}.search-overlay.on{display:flex}
.search-box{width:560px;max-width:92vw;background:var(--card);border:1px solid var(--p);border-radius:14px;overflow:hidden;box-shadow:0 8px 40px rgba(108,92,231,.3)}
.search-box input{width:100%;padding:14px 18px;background:transparent;border:none;border-bottom:1px solid var(--brd);color:var(--tx);font-family:inherit;font-size:1rem;outline:none}
.search-results{max-height:350px;overflow-y:auto;padding:6px}
.sr{display:flex;align-items:center;gap:10px;padding:8px 12px;border-radius:8px;cursor:pointer;transition:all .15s}.sr:hover,.sr.sel{background:rgba(108,92,231,.12)}
.sr .sri{font-size:1.1rem;flex-shrink:0}.sr .srt{flex:1;min-width:0}.sr .srt .t{font-size:.88rem;font-weight:500;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.sr .srt .s{font-size:.7rem;color:var(--dim);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.sr .srty{font-family:'JetBrains Mono',monospace;font-size:.58rem;color:var(--dim);background:rgba(255,255,255,.05);padding:1px 5px;border-radius:3px}
.search-hint{padding:16px;text-align:center;color:var(--dim);font-size:.82rem}
/* TIMELINE */
.tl-item{display:flex;gap:10px;padding:6px 0;border-bottom:1px solid rgba(108,92,231,.08)}.tl-item:last-child{border:none}
.tl-dot{width:8px;height:8px;border-radius:50%;background:var(--pl);margin-top:5px;flex-shrink:0}
.tl-dot.done{background:var(--g)}.tl-dot.add{background:var(--o)}.tl-dot.forge{background:var(--o)}
.tl-body{flex:1}.tl-body .act{font-size:.82rem}.tl-body .det{font-size:.72rem;color:var(--dim)}.tl-body .time{font-family:'JetBrains Mono',monospace;font-size:.6rem;color:var(--dim);margin-top:1px}
/* Chat, Modals, Notes - same as v4 */
.cht-tog{position:fixed;bottom:18px;right:18px;width:46px;height:46px;border-radius:50%;background:linear-gradient(135deg,var(--p),#ec4899);border:none;color:#fff;font-size:1.2rem;cursor:pointer;z-index:150;box-shadow:0 4px 18px rgba(108,92,231,.4);transition:all .3s;display:flex;align-items:center;justify-content:center}.cht-tog:hover{transform:scale(1.1)}
.cht{position:fixed;bottom:72px;right:18px;width:370px;max-height:480px;background:var(--card);border:1px solid var(--hbr);border-radius:15px;z-index:150;display:none;flex-direction:column;overflow:hidden;box-shadow:0 8px 36px rgba(0,0,0,.5)}.cht.open{display:flex}
.cht-h{display:flex;align-items:center;gap:8px;padding:10px 14px;border-bottom:1px solid var(--brd);background:rgba(168,85,247,.06)}.cht-h .av{width:26px;height:26px;background:linear-gradient(135deg,var(--p),#ec4899);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.75rem;flex-shrink:0}
.cht-h .tt{flex:1;font-weight:600;font-size:.87rem}.cht-h select{padding:2px 5px;background:var(--bg);border:1px solid var(--brd);border-radius:5px;color:var(--tx);font-size:.7rem;max-width:120px}.cht-h .cl{background:none;border:none;color:var(--dim);cursor:pointer;font-size:.9rem}
.cht-b{flex:1;overflow-y:auto;padding:10px;max-height:320px;min-height:180px}
.cm{margin-bottom:8px;max-width:88%}.cm.u{margin-left:auto;text-align:right}.cm .bbl{display:inline-block;padding:7px 10px;border-radius:10px;font-size:.82rem;line-height:1.4}
.cm.u .bbl{background:rgba(108,92,231,.2);border:1px solid rgba(108,92,231,.3)}.cm.h .bbl{background:rgba(168,85,247,.1);border:1px solid var(--hbr)}
.cm .w{font-size:.55rem;color:var(--dim);margin-bottom:1px;font-family:'JetBrains Mono',monospace}
.cht-t{padding:6px 10px;font-size:.75rem;color:var(--pl);font-style:italic;display:none}
.cht-i{display:flex;gap:5px;padding:8px 10px;border-top:1px solid var(--brd)}.cht-i input{flex:1;padding:7px 10px;background:var(--bg);border:1px solid var(--brd);border-radius:7px;color:var(--tx);font-family:inherit;font-size:.83rem;outline:none}.cht-i input:focus{border-color:var(--p)}.cht-i button{padding:7px 12px;background:var(--p);color:#fff;border:none;border-radius:7px;font-weight:600;font-size:.83rem;cursor:pointer}
.mbg{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(4px);z-index:200;align-items:center;justify-content:center}.mbg.on{display:flex}
.modal{background:var(--card);border:1px solid var(--brd);border-radius:16px;padding:24px;width:440px;max-width:92vw;max-height:85vh;overflow-y:auto}
.modal h2{font-family:'Playfair Display',serif;font-weight:700;font-size:1.1rem;margin-bottom:14px}
.modal label{display:block;font-size:.75rem;color:var(--dim);margin-bottom:3px;margin-top:8px}
.modal input,.modal select,.modal textarea{width:100%;padding:7px 10px;background:var(--bg);border:1px solid var(--brd);border-radius:7px;color:var(--tx);font-family:inherit;font-size:.84rem;outline:none}
.modal textarea{resize:vertical;min-height:50px}.modal input:focus,.modal textarea:focus{border-color:var(--p)}
.emj{display:flex;gap:4px;flex-wrap:wrap;margin-top:4px}.ep{width:30px;height:30px;border-radius:6px;border:1px solid var(--brd);background:var(--bg);font-size:.95rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}.ep:hover,.ep.sel{border-color:var(--p);background:rgba(108,92,231,.15)}
.macts{display:flex;gap:7px;margin-top:16px;justify-content:flex-end}.macts button{padding:7px 14px;border-radius:7px;font-family:inherit;font-weight:600;font-size:.8rem;cursor:pointer;transition:all .2s}
.bx{background:none;border:1px solid var(--brd);color:var(--dim)}.bx:hover{border-color:var(--dim);color:var(--tx)}.bok{background:var(--p);border:none;color:#fff}.bok:hover{background:var(--pd)}.bdel{background:var(--r);border:none;color:#fff}
.inb{display:flex;align-items:center;gap:7px;padding:8px;border:1px solid var(--brd);border-radius:9px;margin-bottom:6px;background:rgba(255,255,255,.02)}
.inb .inf{flex:1;min-width:0}.inb .inf .lbl{font-size:.84rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.inb .inf .url{font-family:'JetBrains Mono',monospace;font-size:.6rem;color:var(--dim);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.inb select{width:120px;padding:4px 6px;background:var(--bg);border:1px solid var(--brd);border-radius:5px;color:var(--tx);font-size:.75rem;flex-shrink:0}
.inb button{padding:4px 8px;border:none;border-radius:5px;font-size:.75rem;cursor:pointer;flex-shrink:0;font-weight:600}.inb .cfy{background:var(--g);color:#fff}.inb .trsh{background:var(--r);color:#fff}
.note-modal{width:800px;max-width:95vw;max-height:95vh;display:flex;flex-direction:column}
.ne-toolbar{display:flex;gap:3px;flex-wrap:wrap;padding:6px 0;border-bottom:1px solid var(--brd);margin-bottom:8px}
.ne-toolbar button{background:var(--bg);border:1px solid var(--brd);color:var(--tx);padding:4px 8px;border-radius:5px;cursor:pointer;font-size:.75rem;font-family:inherit;transition:all .15s}.ne-toolbar button:hover{border-color:var(--p);color:var(--pl)}.ne-toolbar .sep{width:1px;background:var(--brd);margin:0 4px}
.ne-editor{width:100%;min-height:55vh;max-height:75vh;background:var(--bg);border:1px solid var(--brd);border-radius:8px;color:var(--tx);font-family:'JetBrains Mono',monospace;font-size:.85rem;line-height:1.6;padding:12px;outline:none;resize:vertical;tab-size:2}.ne-editor:focus{border-color:var(--p)}
.ne-meta{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap}.ne-meta select{flex:1;min-width:120px}
.nlist{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:10px;margin-top:10px}
.ncard{background:rgba(255,255,255,.02);border:1px solid var(--brd);border-radius:10px;padding:12px;cursor:pointer;transition:all .2s;position:relative}.ncard:hover{border-color:var(--p);background:rgba(108,92,231,.05)}
.ncard .ntitle{font-weight:600;font-size:.88rem;margin-bottom:4px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.ncard .nprev{font-size:.76rem;color:var(--dim);line-height:1.4;max-height:3.2em;overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}
.ncard .nmeta{font-family:'JetBrains Mono',monospace;font-size:.58rem;color:var(--dim);margin-top:6px;display:flex;gap:6px;flex-wrap:wrap}
.ncard .ndel{position:absolute;top:6px;right:6px;background:none;border:none;color:var(--dim);cursor:pointer;font-size:.7rem;opacity:0;transition:opacity .15s}.ncard:hover .ndel{opacity:1}.ncard .ndel:hover{color:var(--r)}
.toast{position:fixed;bottom:18px;left:50%;transform:translateX(-50%) translateY(80px);background:var(--card);border:1px solid var(--g);color:var(--tx);padding:8px 16px;border-radius:9px;font-size:.83rem;z-index:300;opacity:0;transition:all .3s}.toast.show{transform:translateX(-50%) translateY(0);opacity:1}.toast.err{border-color:var(--r)}.toast.hyp{border-color:var(--pl)}
@media(max-width:700px){.grid{grid-template-columns:1fr}.sb{display:none}.cnt{padding:12px}.it .vl,.it .nt,.it .cat-tag{display:none}.cht{width:calc(100vw - 16px);right:8px;bottom:66px}.note-modal{width:95vw}.dash-stats{grid-template-columns:repeat(2,1fr)}}

.lev-tabs{display:flex;gap:3px;justify-content:center;margin-bottom:18px;background:rgba(18,18,26,.8);border-radius:8px;padding:3px;border:1px solid rgba(42,42,58,.6)}
.lev-tab{padding:6px 14px;border-radius:6px;border:none;background:transparent;color:var(--dim);font-size:.75rem;cursor:pointer;font-family:inherit;transition:all .2s;letter-spacing:.5px}.lev-tab:hover{color:var(--tx)}.lev-tab.on{background:rgba(212,165,116,.15);color:#d4a574;font-weight:600;letter-spacing:1px}
.lev-head{text-align:center;margin-bottom:20px}.lev-head .pre{font-family:'JetBrains Mono',monospace;font-size:.6rem;color:#5a5660;letter-spacing:3px;text-transform:uppercase;margin-bottom:4px}.lev-head h2{font-family:'Playfair Display',serif;font-size:1.5rem;font-weight:300;color:#e8e4df;margin:0}.lev-head .sub{font-size:.78rem;color:#8a8690;margin-top:4px;font-style:italic}
.lev-card{background:#12121a;border:1px solid #2a2a3a;border-radius:10px;padding:14px;transition:all .2s;cursor:pointer}.lev-card:hover{border-color:#6C5CE7}
.lev-bar{height:3px;background:#2a2a3a;border-radius:2px;overflow:hidden;margin-top:4px}.lev-bar .fill{height:100%;border-radius:2px;transition:width .6s ease}
.lev-fulcro-btn{background:#12121a;border:1px solid #2a2a3a;border-radius:8px;padding:14px 18px;cursor:pointer;transition:all .3s;flex:1;max-width:220px;text-align:center}.lev-fulcro-btn:hover{border-color:#6C5CE7}.lev-fulcro-btn.on{border-color:var(--active-color)}
.lev-item{display:flex;align-items:center;gap:12px;padding:10px 14px;background:#0a0a1a;border-radius:8px;border:1px solid #2a2a3a}
.lev-layer{width:100%;display:flex;align-items:center;gap:14px;padding:12px 16px;background:#12121a;border:1px solid #2a2a3a;border-radius:8px;cursor:pointer;transition:all .2s;text-align:left;font-family:inherit}.lev-layer:hover{border-color:#6C5CE7}
.lev-layer .num{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.9rem;font-weight:700;flex-shrink:0}
.lev-st{font-family:'JetBrains Mono',monospace;font-size:.6rem;letter-spacing:1px;padding:3px 8px;border-radius:4px;font-weight:600;flex-shrink:0}
.lev-detail{margin:3px 0 6px 46px;padding:10px 14px;background:#0a0a1a;border-radius:8px;border-left:3px solid;font-size:.82rem;line-height:1.6;color:#e8e4df}
.lev-detail .tags{display:flex;gap:4px;flex-wrap:wrap;margin-top:6px}.lev-detail .tag{font-size:.68rem;padding:2px 8px;border-radius:10px;border:1px solid}
.lev-grid3{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
.lev-grid4{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
.lev-grid6{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
.lev-insight{padding:14px;border-radius:8px;margin-top:16px}
.lev-diag{background:#12121a;border:1px solid #2a2a3a;border-radius:10px;padding:14px;margin-bottom:10px}
.lev-diag .row3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin:8px 0}
.lev-flywheel-node{text-align:center;padding:14px;background:#12121a;border:1px solid #2a2a3a;border-radius:10px;cursor:pointer;transition:all .2s}.lev-flywheel-node:hover{transform:translateY(-2px);border-color:#d4a574}
@media(max-width:700px){.lev-grid3,.lev-grid4{grid-template-columns:1fr 1fr}.lev-grid6{grid-template-columns:1fr 1fr}}

.ncards-row{display:flex;gap:8px;overflow-x:auto;padding:6px 0 10px;scroll-snap-type:x mandatory}
.ncard-mini{min-width:160px;max-width:200px;background:var(--card);border:1px solid var(--brd);border-radius:8px;padding:10px 12px;cursor:pointer;scroll-snap-align:start;transition:all .2s;flex-shrink:0}
.ncard-mini:hover{border-color:var(--pl);transform:translateY(-2px);box-shadow:0 4px 12px rgba(108,92,231,.15)}
.ncm-title{font-size:.82rem;font-weight:600;color:var(--tx);margin-bottom:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.ncm-prev{font-size:.7rem;color:var(--dim);line-height:1.4;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;min-height:2.2em}
.ncm-date{font-size:.6rem;color:var(--mute);margin-top:6px;font-family:'JetBrains Mono',monospace}
#injTA{width:100%;min-height:300px;background:var(--bg);color:var(--tx);border:1px solid var(--brd);border-radius:8px;padding:12px;font-family:'JetBrains Mono',monospace;font-size:.78rem;resize:vertical;line-height:1.5}
#injRes{margin-top:8px;font-size:.82rem;min-height:20px}
.inj-btns{display:flex;gap:8px;margin-top:10px}
.inj-btns button{flex:1}

.ncm-foot{display:flex;justify-content:space-between;align-items:center;margin-top:6px}
.ncm-acts{display:flex;gap:3px}

.ncm-btn{width:24px;height:24px;border:1px solid var(--brd);border-radius:6px;background:var(--bg);color:var(--dim);font-size:.7rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .15s;padding:0;line-height:1}
.ncm-btn:hover{border-color:var(--pl);color:var(--pl);background:rgba(108,92,231,.1)}
#vnBody{line-height:1.7;font-size:.88rem;color:var(--tx);max-height:60vh;overflow-y:auto;padding:4px 0}
#vnBody h1,#vnBody h2,#vnBody h3{color:var(--pl);margin:12px 0 6px}
#vnBody code{background:rgba(108,92,231,.12);padding:1px 5px;border-radius:3px;font-family:'JetBrains Mono',monospace;font-size:.82rem}
#vnBody blockquote{border-left:3px solid var(--pl);padding-left:10px;color:var(--dim);margin:6px 0}
#vnBody strong{color:var(--tx)}
#vnMeta{font-size:.72rem;color:var(--dim);margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid var(--brd)}
</style>
</head>
<body>
<div id="loginScreen"><div class="lbox"><h1>üî® DayForge</h1><p class="sub">Forja tu d√≠a la noche anterior</p><input type="text" id="loginUser" placeholder="Usuario"><input type="password" id="loginPass" placeholder="Contrase√±a"><button onclick="doLogin()">Entrar</button><div class="lerr" id="loginErr"></div></div></div>
<div id="appScreen">
<div class="hdr"><div class="hdr-l"><span class="logo" onclick="showDash()">üî® DayForge</span></div><div class="hdr-r">
<button class="hb" onclick="showDash()" id="dashBtn" title="Dashboard">üìä</button>
<button class="hb" onclick="showTimeline()" id="tlBtn" title="Timeline">üïê</button>
<button class="hb" onclick="showInbox()" id="inboxBtn">üì•<span class="badge" id="ibBadge" style="display:none">0</span></button>
<button class="hb" onclick="showNotesList()">üìù</button>
<button class="hb" onclick="showLeverage()" id="levBtn" title="Ecosistema de Apalancamiento">‚ö°</button><button class="hb" onclick="showInject()" title="Inyector JSON">üì•</button><button class="hb" onclick="openSearch()" title="Ctrl+K">üîç</button>
<button class="hb" onclick="showBm()">üìé</button>
<div class="dev"><div class="ddot" id="agDot"></div><span id="agLbl">...</span></div>
<button class="hb" onclick="loadAll()">‚Üª</button><button class="hb" onclick="doLogout()">Salir</button></div></div>
<div class="grid">
<div class="sb" id="sidebar">
<div class="sbs"><div class="sbt">Workspaces</div><div id="sbW"></div><div class="sadd" onclick="openNewWs()">+ Nuevo</div></div>
<div class="sbs" id="pinSec" style="display:none"><div class="sbt">üìå Permanentes</div><div id="sbP"></div><div class="sadd" onclick="addPerm()">+ Enlace fijo</div></div>
<div class="sbs" style="border-top:1px solid var(--brd);padding-top:10px;margin-top:auto"><div class="sbt">üöÄ Apps (global)</div><div id="sbA"></div>
<div class="srow" style="flex-wrap:wrap"><input type="text" id="newAppN" placeholder="Nombre" style="width:35%"><input type="text" id="newAppP" placeholder="URL o ruta" onkeydown="if(event.key==='Enter')addGApp()"><button onclick="addGApp()">+</button></div>
<button class="slaunch" id="launchBtn" onclick="launchSelApps()" disabled>üöÄ Lanzar</button></div></div>
<div class="cnt" id="content">
<div class="hyp"><div class="av">üíú</div><div class="bd"><div class="lb">Hypatia</div><div class="mg" id="hypMsg">Cargando...</div></div><button class="rf" onclick="loadHyp()">‚Üª</button></div>
<div id="wsC"><div class="emp"><div class="ic">üî®</div><p>Selecciona un workspace o pulsa üìä para el dashboard.</p></div></div></div></div>
<button class="cht-tog" onclick="togChat()">üíú</button>
<div class="cht" id="chatP"><div class="cht-h"><div class="av">üíú</div><span class="tt">Hypatia</span><select id="chatWs" onchange="loadCHist()"></select><button class="cl" onclick="togChat()">‚úï</button></div><div class="cht-b" id="chatB"></div><div class="cht-t" id="chatT">Hypatia piensa...</div><div class="cht-i"><input type="text" id="chatIn" placeholder="H√°blame..." onkeydown="if(event.key==='Enter')sendChat()"><button onclick="sendChat()">‚Üí</button></div></div>
</div>
<!-- Search overlay -->
<div class="search-overlay" id="searchOv" onclick="if(event.target===this)closeSearch()"><div class="search-box"><input type="text" id="searchIn" placeholder="Buscar en todo DayForge..." oninput="doSearch()" onkeydown="searchNav(event)"><div class="search-results" id="searchRes"><div class="search-hint">Escribe para buscar en workspaces, items y notas...</div></div></div></div>
<!-- Modals: same structure -->
<div class="mbg" id="wsM"><div class="modal"><h2 id="wsMT">Nuevo Workspace</h2><label>Nombre</label><input type="text" id="wsN" maxlength="40"><label>Icono</label><div class="emj" id="emjP"></div><input type="text" id="wsIC" placeholder="Emoji" maxlength="2" style="margin-top:4px;width:55px"><div class="macts"><button class="bx" onclick="closeM('wsM')">Cancelar</button><button class="bdel" id="wsDel" style="display:none" onclick="deleteWs()">Eliminar</button><button class="bok" onclick="saveWs()">Guardar</button></div></div></div>
<div class="mbg" id="eiM"><div class="modal"><h2>Editar Item</h2><label>Tipo</label><select id="eT"><option value="url">üåê URL</option><option value="file">üìÑ Archivo</option><option value="note">üìù Nota</option></select><label>Valor</label><input type="text" id="eV"><label>Etiqueta</label><input type="text" id="eL"><label>Categor√≠a</label><select id="eC"></select><label>Notas</label><textarea id="eN" placeholder="Apuntes..."></textarea><label>Mover a</label><select id="eW"></select><label style="margin-top:10px"><input type="checkbox" id="eP" style="width:auto;margin-right:5px"> üìå Permanente</label><div class="macts"><button class="bx" onclick="closeM('eiM')">Cancelar</button><button class="bok" onclick="saveEdit()">Guardar</button></div></div></div>
<div class="mbg" id="catM"><div class="modal"><h2 id="catMT">Nueva Categor√≠a</h2><label>Nombre</label><input type="text" id="catN" maxlength="40"><label>Descripci√≥n</label><textarea id="catD" placeholder="¬øPara qu√©?"></textarea><div class="macts"><button class="bx" onclick="closeM('catM')">Cancelar</button><button class="bdel" id="catDel" style="display:none" onclick="deleteCat()">Eliminar</button><button class="bok" onclick="saveCat()">Guardar</button></div></div></div>
<div class="mbg" id="ibM"><div class="modal" style="width:500px"><h2>üì• Inbox</h2><p style="color:var(--dim);font-size:.8rem;margin-bottom:10px">Asigna o elimina.</p><div id="ibItems"></div><div id="ibEmpty" style="display:none;text-align:center;padding:16px;color:var(--dim)">‚úÖ Vac√≠o</div><div class="macts"><button class="bok" onclick="closeM('ibM')">Cerrar</button></div></div></div>
<div class="mbg" id="bmM"><div class="modal"><h2>üìé Bookmarklet</h2><p style="color:var(--dim);font-size:.84rem;margin-bottom:12px;line-height:1.5">Arrastra a marcadores:</p><div style="text-align:center;margin:14px 0"><a id="bmL" href="#" style="display:inline-block;padding:9px 18px;background:linear-gradient(135deg,var(--p),var(--o));color:#fff;border-radius:7px;text-decoration:none;font-weight:600;cursor:grab" onclick="event.preventDefault()">üìé + DayForge</a></div><div class="macts"><button class="bok" onclick="closeM('bmM')">OK</button></div></div></div>
<div class="mbg" id="nlM"><div class="modal" style="width:700px;max-width:95vw"><h2>üìù Notas</h2><div style="display:flex;gap:6px;margin-bottom:10px;align-items:center"><select id="nlWsF" onchange="loadNotes()" style="padding:5px 8px;background:var(--bg);border:1px solid var(--brd);border-radius:6px;color:var(--tx);font-size:.78rem"><option value="">Todos</option></select><button class="bok" style="font-size:.78rem;padding:5px 12px" onclick="openNewNote()">+ Nueva</button></div><div id="nlGrid" class="nlist"></div><div class="macts" style="margin-top:14px"><button class="bok" onclick="closeM('nlM')">Cerrar</button></div></div></div>
<div class="mbg" id="neM"><div class="modal note-modal"><h2 id="neMT">Nueva Nota</h2><input type="text" id="neTitle" placeholder="T√≠tulo..." style="font-size:1rem;font-weight:600;padding:10px 12px;margin-bottom:4px">
<div class="ne-toolbar"><button onclick="neFmt('**','**')"><b>B</b></button><button onclick="neFmt('*','*')"><i>I</i></button><button onclick="neFmt('~~','~~')"><s>S</s></button><button onclick="neFmt('`','`')">‚å®</button><div class="sep"></div><button onclick="neIns('# ')">H1</button><button onclick="neIns('## ')">H2</button><button onclick="neIns('### ')">H3</button><div class="sep"></div><button onclick="neIns('- ')">‚Ä¢ Lista</button><button onclick="neIns('1. ')">1.</button><button onclick="neIns('- [ ] ')">‚òê</button><div class="sep"></div><button onclick="neIns('> ')">‚ùù</button><button onclick="neFmt('\n```\n','\n```\n')">{ }</button><button onclick="neIns('---\n')">‚Äî</button><button onclick="neFmt('[','](url)')">üîó</button><div class="sep"></div><button onclick="nePreview()">üëÅ</button></div>
<textarea class="ne-editor" id="neBody" placeholder="Escribe en markdown..."></textarea><div id="nePreviewBox" style="display:none;background:var(--bg);border:1px solid var(--brd);border-radius:8px;padding:12px;min-height:200px;max-height:50vh;overflow-y:auto;font-size:.88rem;line-height:1.7"></div>
<div class="ne-meta"><div style="flex:1"><label style="font-size:.7rem;margin:0">Workspaces</label><select id="neWs" multiple size="2" style="font-size:.75rem"></select></div><div style="flex:1"><label style="font-size:.7rem;margin:0">Categor√≠as</label><select id="neCat" multiple size="2" style="font-size:.75rem"></select></div></div>
<div class="macts"><button class="bx" onclick="closeNoteEd()">Cancelar</button><button class="bdel" id="neDel" style="display:none" onclick="deleteNote()">Eliminar</button><button class="bok" onclick="saveNote()">Guardar</button></div></div></div>
<div class="toast" id="toast"></div>
<script src="/static/app.js"></script>

<div class="modal" id="injM"><div class="mc" style="max-width:700px">
  <div class="mh"><h3>üì• Inyector JSON</h3><button onclick="closeM('injM')">‚úï</button></div>
  <div class="mb">
    <div style="font-size:.78rem;color:var(--dim);margin-bottom:8px">Pega aqu√≠ el JSON generado por Hypatia para importar workspaces, tareas y notas de golpe.</div>
    <textarea id="injTA" placeholder='{"workspaces":[{"name":"...","icon":"üöÄ","items":[...],"notes":[...]}]}'></textarea>
    <div id="injRes"></div>
    <div class="inj-btns">
      <button onclick="injectSample()" class="wb">üìã Ejemplo</button>
      <button onclick="doInject()" style="background:var(--pl);color:#fff;font-weight:600">üöÄ Inyectar</button>
    </div>
  </div>
</div></div>

<div class="modal" id="vnM"><div class="mc" style="max-width:650px">
  <div class="mh"><h3 id="vnTitle">Nota</h3><button onclick="closeM('vnM')">‚úï</button></div>
  <div class="mb">
    <div id="vnMeta"></div>
    <div id="vnBody"></div>
    <div style="margin-top:14px;text-align:right"><button id="vnEditBtn" style="background:var(--pl);color:#fff;padding:6px 16px;border-radius:6px;border:none;cursor:pointer;font-size:.82rem">‚úé Editar</button></div>
  </div>
</div></div>
</body>
</html>